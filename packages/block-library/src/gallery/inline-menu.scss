figure.blocks-gallery-image {

	&.is-selected .block-library-gallery-item__move-menu,
	&.is-selected .block-library-gallery-item__inline-menu {
		background-color: theme(primary);

		.components-button {
			color: $white;
			padding: 2px;
			width: $icon-button-size-small;
			height: $icon-button-size-small;

			// Remove hover/focus box shadows, since they clash with the blue background.
			&:not(:disabled):not([aria-disabled="true"]):not(.is-default):hover,
			&:focus:not(:disabled) {
				box-shadow: none;
			}

			@include break-small() {
				// Use smaller buttons to fit when there are many columns.
				.columns-7 &,
				.columns-8 & {
					padding: 0;
					width: inherit;
					height: inherit;
				}
			}
		}

		.components-button:focus {
			color: inherit;
		}
	}

	.block-editor-rich-text figcaption {
		position: relative;
		overflow: hidden;

		a {
			color: $white;
		}
	}
}

.block-library-gallery-item__move-menu,
.block-library-gallery-item__inline-menu {
	padding: $grid-size-small;
	display: inline-flex;
	z-index: z-index(".block-library-gallery-item__inline-menu");

	.components-button {
		color: transparent;
	}

	@include break-small() {
		// Use smaller buttons to fit when there are many columns.
		.columns-7 &,
		.columns-8 & {
			padding: $grid-size-small / 2;
		}
	}
}

.block-library-gallery-item__inline-menu {
	position: absolute;
	top: -2px;
	right: -2px;
}

.block-library-gallery-item__move-menu {
	position: absolute;
	top: -2px;
	left: -2px;
}

.blocks-gallery-item__move-backward,
.blocks-gallery-item__move-forward,
.blocks-gallery-item__remove {
	padding: 0;
}
